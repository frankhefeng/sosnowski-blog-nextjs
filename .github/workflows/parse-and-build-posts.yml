name: Parse and build posts
on:
    push:
        branches: [ master ]
jobs:
    parse-posts:
        name: Parse posts
        runs-on: ubuntu-latest
        steps:
        # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
        - uses: actions/checkout@v2
          with:
            fetch-depth: 0
        - uses: actions/setup-node@v1
          with:
            node-version: '12'
        - name: Install yarn and dependencies
          run: npx yarn
        # Runs a single command using the runners shell
        - name: Run a one-line script
          run: echo Hello, world!
        - name: Get diff
          run: git diff --name-status --output diff.txt ${{ github.event.before }} ${{ github.sha }}
        - name: Read diff
          run: |
            echo Reading diff file...
            cat diff.txt
        - name: Run script
          run: npx ts-node -s ./.github/actions/read-diff.ts